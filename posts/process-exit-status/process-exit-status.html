<html>
  <head>
    <title>Process Exit Status</title>

    <link rel="stylesheet" href="../../statics/index.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css">
  </head>
  <body>
    <div class="post-page">
      <article class="post">
        <header>
          <h1 class="post__title">Process Exit Status</h1>
          <div class="post__date"></div>
        </header>

        <div class="post__body">
          <p class="post__paragraph">
            Small tip to make your bash shell a bit better.
          </p>

          <p class="post__paragraph">
            There is a nice way to stop being confused when you run a
            command
            and it finishes silently.
          </p>

          <img
            class="post__image"
            alt="Process exited without any message what happened"
            src="no-clue.png"
          />

          <p class="post__paragraph">
            What just happened? Did it fail? Did it do the job but just
            haven't written any message? Mystery.
          </p>

          <p class="post__paragraph">
            To fix it you can write an exit code right after a command output if
            the code was not zero.
          </p>

          <img
            class="post__image"
            alt="Showing exist code after command output"
            src="now-i-see.png"
          />

          <p class="post__paragraph">
            If you are using some popular theme for
            <a href="https://github.com/Bash-it/bash-it">Bash-it</a> you
            probably have this solved already. If not, you're going to need <a
            href="http://www.tldp.org/HOWTO/Bash-Prompt-HOWTO/x264.html">PROMPT_COMMAND</a>
            environment variable.
          </p>

          <p class="post__paragraph">
            Add this to the end of your .bash_profile.
          </p>

          <div class="post__code-block">
            <code class="code-block hljs">
            <pre>
<span class="hljs-function"><span class="hljs-title">show_exit_code</span></span>() {
    <span class="hljs-built_in">local</span> ex=$?

    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$ex</span> -ne 0 ]
    <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\033[0;31m<span
              class="hljs-variable">$ex</span>\033[0m"</span>
    <span class="hljs-keyword">fi</span>
}

PROMPT_COMMAND=<span class="hljs-string">"show_exit_code;<span class="hljs-variable">$PROMPT_COMMAND</span>"</span>
            </pre>
            </code>
          </div>


          <p class="post__paragraph">
            show_exit_code function saves exit code of the last executed command
            and then writes it with a red color if the code is not zero.
          </p>

          <p class="post__paragraph">
            Now, open new tab in terminal or run source ~/.bash_profile and try
            it.
          </p>
        </div>
      </article>
    </div>
  </body>
</html>
